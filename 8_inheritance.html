
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>8. Inheritance and composition &#8212; Object oriented programming in Python for mathematicians 2020.0 documentation</title>
    <link rel="stylesheet" href="_static/fenics.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/proof.js"></script>
    <script async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="9. Debugging and testing" href="9_debugging.html" />
    <link rel="prev" title="7. Midterm test preparation" href="7_midterm.html" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->

<link rel="stylesheet" href="_static/featured.css">


<link rel="shortcut icon" href="_static/icon.ico" />


  </head><body>
<div class="wrapper">
  <a href="index.html"><img src="_static/banner.png" width="900px" alt="FInAT Project Banner" /></a>
  <div id="access">
    <div class="menu">
      <ul>
          <li class="page_item"><a href="https://github.com/object-oriented-python/object-oriented-programming" title="GitHub">GitHub</a></li>
      </ul>
    </div><!-- .menu -->
  </div><!-- #access -->
</div><!-- #wrapper -->


    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="inheritance-and-composition">
<span id="inheritance"></span><h1><span class="section-number">8. </span>Inheritance and composition<a class="headerlink" href="#inheritance-and-composition" title="Permalink to this headline">¶</a></h1>
<p>A key feature of abstractions is composability: the ability to make a
complex object or operation out of several components. We can compose
objects by simply making one object a <a class="reference internal" href="3_objects.html#term-attribute"><span class="xref std std-term">attribute</span></a> of another
object. This combines objects in a <em>has a</em> relationship. For example
the <code class="xref py py-class docutils literal notranslate"><span class="pre">Polynomial</span></code> class introduced in <a class="reference internal" href="3_objects.html#objects"><span class="std std-numref">chapter 3</span></a> <em>has a</em> <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a> of coefficients. Object composition of
this sort is a core part of <a class="reference internal" href="3_objects.html#term-encapsulation"><span class="xref std std-term">encapsulation</span></a>.</p>
<p>Another way of composing abstractions is to make a new <a class="reference internal" href="3_objects.html#term-class"><span class="xref std std-term">class</span></a>
by modifying another class. Typically this is employed to make a more
specialised <a class="reference internal" href="3_objects.html#term-class"><span class="xref std std-term">class</span></a> from a more general one. In fact, we have
already seen this in the case of number classes. Recall that all
numbers are instances of <a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Number" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numbers.Number</span></code></a>:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">from</span> <span class="nn">numbers</span> <span class="kn">import</span> <span class="n">Number</span>

<span class="gp">In [2]: </span><span class="nb">isinstance</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Number</span><span class="p">)</span>
<span class="gh">Out[2]: </span><span class="go">True</span>
</pre></div>
</div>
<p>Hang on, though. <code class="xref py py-obj docutils literal notranslate"><span class="pre">1</span></code> is actually an instance of <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="gp">In [3]: </span><span class="nb">type</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gh">Out[3]: </span><span class="go">int</span>

<span class="gp">In [4]: </span><span class="nb">isinstance</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
<span class="gh">Out[4]: </span><span class="go">True</span>
</pre></div>
</div>
<p>So <code class="xref py py-obj docutils literal notranslate"><span class="pre">1</span></code>, it turns out, has <a class="reference internal" href="3_objects.html#term-type"><span class="xref std std-term">type</span></a> <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, and so is an
instance of <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, but is also somehow an instance of
<a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Number" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numbers.Number</span></code></a>. Mathematically, the answer is obvious:
integers form a subset of all of the numbers. Object inheritance works
in much the same way: we say that <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a> is a <a class="reference internal" href="#term-subclass"><span class="xref std std-term">subclass</span></a>
of <a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Number" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numbers.Number</span></code></a>. Just as <a class="reference external" href="https://docs.python.org/3/library/functions.html#isinstance" title="(in Python v3.9)"><code class="xref py py-func docutils literal notranslate"><span class="pre">isinstance()</span></code></a> provides a
mechanism for determining whether an object is an <a class="reference internal" href="3_objects.html#term-instance"><span class="xref std std-term">instance</span></a> of
a <a class="reference internal" href="3_objects.html#term-class"><span class="xref std std-term">class</span></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#issubclass" title="(in Python v3.9)"><code class="xref py py-func docutils literal notranslate"><span class="pre">issubclass()</span></code></a> will tell us when one
<a class="reference internal" href="3_objects.html#term-class"><span class="xref std std-term">class</span></a> is a <a class="reference internal" href="#term-subclass"><span class="xref std std-term">subclass</span></a> of another:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="gp">In [5]: </span><span class="nb">issubclass</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">Number</span><span class="p">)</span>
<span class="gh">Out[5]: </span><span class="go">True</span>
</pre></div>
</div>
<p>In fact, there is a whole hierarchy of
numeric types in <a class="reference external" href="https://docs.python.org/3/library/numbers.html#module-numbers" title="(in Python v3.9)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">numbers</span></code></a>:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="gp">In [6]: </span><span class="kn">import</span> <span class="nn">numbers</span>

<span class="gp">In [7]: </span><span class="nb">issubclass</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">numbers</span><span class="o">.</span><span class="n">Integral</span><span class="p">)</span>
<span class="gh">Out[7]: </span><span class="go">True</span>

<span class="gp">In [8]: </span><span class="nb">issubclass</span><span class="p">(</span><span class="n">numbers</span><span class="o">.</span><span class="n">Integral</span><span class="p">,</span> <span class="n">numbers</span><span class="o">.</span><span class="n">Rational</span><span class="p">)</span>
<span class="gh">Out[8]: </span><span class="go">True</span>

<span class="gp">In [9]: </span><span class="nb">issubclass</span><span class="p">(</span><span class="n">numbers</span><span class="o">.</span><span class="n">Rational</span><span class="p">,</span> <span class="n">numbers</span><span class="o">.</span><span class="n">Real</span><span class="p">)</span>
<span class="gh">Out[9]: </span><span class="go">True</span>

<span class="gp">In [10]: </span><span class="nb">issubclass</span><span class="p">(</span><span class="n">numbers</span><span class="o">.</span><span class="n">Real</span><span class="p">,</span> <span class="n">numbers</span><span class="o">.</span><span class="n">Complex</span><span class="p">)</span>
<span class="gh">Out[10]: </span><span class="go">True</span>
</pre></div>
</div>
<p>It turns out that <a class="reference external" href="https://docs.python.org/3/library/functions.html#issubclass" title="(in Python v3.9)"><code class="xref py py-func docutils literal notranslate"><span class="pre">issubclass()</span></code></a> is reflexive (classes are subclasses of themselves):</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="gp">In [11]: </span><span class="nb">issubclass</span><span class="p">(</span><span class="n">numbers</span><span class="o">.</span><span class="n">Real</span><span class="p">,</span> <span class="n">numbers</span><span class="o">.</span><span class="n">Real</span><span class="p">)</span>
<span class="gh">Out[11]: </span><span class="go">True</span>
</pre></div>
</div>
<p>This means that, in a manner analogous to subset inclusion, the
<a class="reference internal" href="#term-subclass"><span class="xref std std-term">subclass</span></a> relationship forms a partial order on the set of all
classes. This relationship defines another core mechanism for creating a new
class from existing classes, <a class="reference internal" href="#term-inheritance"><span class="xref std std-term">inheritance</span></a>. If one class is a subclass of
another then we say that it inherits from that class. Where composition defines
a <em>has a</em> relationship, inheritance defines an <em>is a</em> relationship.</p>
<div class="section" id="an-example-from-group-theory">
<h2><span class="section-number">8.1. </span>An example from group theory<a class="headerlink" href="#an-example-from-group-theory" title="Permalink to this headline">¶</a></h2>
<p>In order to illustrate how composition and inheritance work, let’s suppose that
we want to write a module that implements some basic groups. Recall that a group
is a collection of elements, and a group operation which obeys certain axioms.
A computer implementation of a group might therefore involve objects
representing groups, and objects representing elements. We’ll lay out one
possible configuration, which helpfully involves both inheritance and
composition, as well as parametrisation of objects and delegation of methods.</p>
<div class="section" id="cyclic-groups">
<h3><span class="section-number">8.1.1. </span>Cyclic groups<a class="headerlink" href="#cyclic-groups" title="Permalink to this headline">¶</a></h3>
<p>Let’s start with the cyclic groups of order <span class="math notranslate nohighlight">\(n\)</span>. These are isomorphic to
the integers under addition modulo <span class="math notranslate nohighlight">\(n\)</span>, a property which we can use to
create our implementation. We’re going to eventually want to make different
types of groups, so we’re going to need to carefully consider what changes from
group to group, and what is the same. The first thing that we observe is that
different cyclic groups differ only by their order, so we could quite easily
have a single cyclic group class, and set the order when we <a class="reference internal" href="3_objects.html#term-instantiate"><span class="xref std std-term">instantiate</span></a>
it. This is pretty common: groups often come in families defined by some sort of
size parameter. A group is defined by what values its elements can take, and the
group operation. We might therefore be tempted to think that we need to define a
cyclic group element type which can take the relevant values and which
implements the group operation. This would be unfortunate for at least two
reasons:</p>
<ol class="arabic simple">
<li><p>Because each group needs several elements, need a different element <em>type</em>
for each <em>instance</em> of a cyclic group. The number of classes needed would grow very fast!</p></li>
<li><p>Adding a new family of groups would require adding both a group class and a
set of element classes. On grounds of simplicity and robustness, always key considerations,
we would much prefer to only add one class in order to add a new family of
groups.</p></li>
</ol>
<p>Instead, we can make a single generic element type, and pass the group as an
<a class="reference external" href="https://docs.python.org/3/glossary.html#term-argument" title="(in Python v3.9)"><span class="xref std std-term">argument</span></a> when instantiating the element. This is an example of
<a class="reference internal" href="#term-composition"><span class="xref std std-term">composition</span></a>: each element <em>has a</em> group. The group will then implement
methods which check that element values are allowed for that group, and a method
which implements the group operation. Element objects will then <a class="reference internal" href="#term-delegation"><span class="xref std std-term">delegate</span></a> validation and the group operation back to the group object.</p>
<p>Finally, we will want an <a class="reference internal" href="3_objects.html#term-infix-operator"><span class="xref std std-term">infix operator</span></a> representing the group
operation. Group theorists often use a dot, but we need to choose one of the
infix operators that Python supports. We’ll chose <code class="xref py py-obj docutils literal notranslate"><span class="pre">*</span></code>, which is possibly the
closest match among Python’s operators. One could easily envisage a more
complete implementation of a group, with support for group properties such as
generators and element features such as inverses. But our objective here is to
develop an understanding of class relations, rather than of algebra, so this
minimal characterisation of a group will suffice.</p>
<div class="literal-block-wrapper docutils container" id="cyclic-group">
<div class="code-block-caption"><span class="caption-number">Listing 8.1 </span><span class="caption-text">A simple implementation of a cyclic group class, and a generic
group element.</span><a class="headerlink" href="#cyclic-group" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Element</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">group</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="n">group</span><span class="o">.</span><span class="n">_validate</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">group</span> <span class="o">=</span> <span class="n">group</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>

    <span class="k">def</span> <span class="fm">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Use * to represent the group operation.&#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="n">Element</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">group</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">group</span><span class="o">.</span><span class="n">operation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                                            <span class="n">other</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">group</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span> \
            <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">group</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>


<span class="k">class</span> <span class="nc">CyclicGroup</span><span class="p">:</span>
    <span class="sd">&#39;&#39;&#39;A cyclic group represented by integer addition modulo group order.&#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="n">order</span>

    <span class="k">def</span> <span class="nf">_validate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Ensure that value is a legitimate element value in this group.&#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Integral</span><span class="p">)</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Element value must be an integer&quot;</span>
                            <span class="sa">f</span><span class="s2">&quot; in the range [0, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">operation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Provide a convenient way to create elements of this group.&#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="n">Element</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;C</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>
</pre></div>
</td></tr></table></div>
</div>
<p><a class="reference internal" href="#cyclic-group"><span class="std std-numref">Listing 8.1</span></a> shows an implementation of our minimal conception of
cyclic groups. Before considering it in any detail let’s try it out to observe
the concrete effects of the classes:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">from</span> <span class="nn">example_code.groups_basic</span> <span class="kn">import</span> <span class="n">CyclicGroup</span>

<span class="gp">In [2]: </span><span class="n">C</span> <span class="o">=</span> <span class="n">CyclicGroup</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>

<span class="gp">In [3]: </span><span class="nb">print</span><span class="p">(</span><span class="n">C</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">C</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="go">2_C5</span>
</pre></div>
</div>
<p>We observe that we are able to create the cyclic group of order 5. Due to the
definition of the <code class="xref py py-meth docutils literal notranslate"><span class="pre">__call__()</span></code> <a class="reference internal" href="3_objects.html#term-special-method"><span class="xref std std-term">special method</span></a> at line 35, we are
then able to create elements of the group by calling the group object. The group
operation then has the expected effect:</p>
<div class="math notranslate nohighlight">
\[\begin{split}3_{C_5} \cdot 4_{C_5} &amp;\equiv (3 + 4) \operatorname{mod} 5\\
&amp;= 2\\
&amp;\equiv 2_{C_5}\end{split}\]</div>
<p>Finally, if we attempt to make a group element with a value which is not an
integer between 0 and 5, an exception is raised.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="gp">In [4]: </span><span class="n">C</span><span class="p">(</span><span class="mf">1.5</span><span class="p">)</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">4</span><span class="o">-</span><span class="n">a5d8472d4486</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">C</span><span class="p">(</span><span class="mf">1.5</span><span class="p">)</span>

<span class="nn">~/docs/principles_of_programming/object-oriented-programming/example_code/groups_basic.py</span> in <span class="ni">__call__</span><span class="nt">(self, value)</span>
<span class="g g-Whitespace">    </span><span class="mi">38</span>     <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">39</span>         <span class="sd">&#39;&#39;&#39;Provide a convenient way to create elements of this group.&#39;&#39;&#39;</span>
<span class="ne">---&gt; </span><span class="mi">40</span>         <span class="k">return</span> <span class="n">Element</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">41</span>
<span class="g g-Whitespace">    </span><span class="mi">42</span>     <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="nn">~/docs/principles_of_programming/object-oriented-programming/example_code/groups_basic.py</span> in <span class="ni">__init__</span><span class="nt">(self, group, value)</span>
<span class="g g-Whitespace">    </span><span class="mi">4</span> <span class="k">class</span> <span class="nc">Element</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">5</span>     <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">group</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="ne">----&gt; </span><span class="mi">6</span>         <span class="n">group</span><span class="o">.</span><span class="n">_validate</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">7</span>         <span class="bp">self</span><span class="o">.</span><span class="n">group</span> <span class="o">=</span> <span class="n">group</span>
<span class="g g-Whitespace">    </span><span class="mi">8</span>         <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>

<span class="nn">~/docs/principles_of_programming/object-oriented-programming/example_code/groups_basic.py</span> in <span class="ni">_validate</span><span class="nt">(self, value)</span>
<span class="g g-Whitespace">    </span><span class="mi">30</span>         <span class="sd">&#39;&#39;&#39;Ensure that value is a legitimate element value in this group.&#39;&#39;&#39;</span>
<span class="g g-Whitespace">    </span><span class="mi">31</span>         <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Integral</span><span class="p">)</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">):</span>
<span class="ne">---&gt; </span><span class="mi">32</span>             <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Element value must be an integer&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">33</span>                              <span class="sa">f</span><span class="s2">&quot; in the range [0, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">34</span>

<span class="ne">ValueError</span>: Element value must be an integer in the range [0, 5)
</pre></div>
</div>
<p><a class="reference internal" href="#cyclic-group"><span class="std std-numref">Listing 8.1</span></a> illustrates <a class="reference internal" href="#term-composition"><span class="xref std std-term">composition</span></a>: on line 4
<a class="reference internal" href="example_code.html#example_code.groups_basic.Element" title="example_code.groups_basic.Element"><code class="xref py py-class docutils literal notranslate"><span class="pre">Element</span></code></a>, is associated with a group object.
This is a classic <em>has a</em> relationship: an element has a group. We might have
attempted to construct this the other way around with classes having elements,
however this would have immediately hit the issue that elements have exactly one
group, while a group might have an unlimited number of elements. Object
composition is typically most successful when the relationship is uniquely
defined.</p>
<p>This code also demonstrates <a class="reference internal" href="#term-delegation"><span class="xref std std-term">delegation</span></a>. In order to avoid having to
define different element classes for different groups, the element class does
not in substance implement either value validation, or the group operation.
Instead, at line 3, validation is delegated to the group by calling
<code class="xref py py-meth docutils literal notranslate"><span class="pre">group._validate()</span></code> and at line 10 the implementation of the group operation
is delegated to the group by calling <code class="xref py py-meth docutils literal notranslate"><span class="pre">self.group.operation()</span></code>.</p>
</div>
<div class="section" id="general-linear-groups">
<h3><span class="section-number">8.1.2. </span>General linear groups<a class="headerlink" href="#general-linear-groups" title="Permalink to this headline">¶</a></h3>
<p>We still haven’t encountered inheritance, though. Where does that come into the
story? Well first we’ll need to introduce at least one more family of groups.
For no other reason than convenience, let’s choose <span class="math notranslate nohighlight">\(G_n\)</span>, the general
linear group of degree <span class="math notranslate nohighlight">\(n\)</span>. The elements of this group can be
represented as <span class="math notranslate nohighlight">\(n\times n\)</span> invertible square matrices. At least to the
extent that real numbers can be represented on a computer, we can implement this
group as follows:</p>
<div class="literal-block-wrapper docutils container" id="general-linear-group">
<div class="code-block-caption"><span class="caption-number">Listing 8.2 </span><span class="caption-text">A basic implementation of the general linear group of a given
degree.</span><a class="headerlink" href="#general-linear-group" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">GeneralLinearGroup</span><span class="p">:</span>
    <span class="sd">&#39;&#39;&#39;The general linear group represented by degree x degree matrices.&#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">degree</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">degree</span> <span class="o">=</span> <span class="n">degree</span>

    <span class="k">def</span> <span class="nf">_validate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Ensure that value is a legitimate element value in this group.&#39;&#39;&#39;</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">degree</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Element value must be a &quot;</span>
                             <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">degree</span><span class="si">}</span><span class="s2"> x </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">degree</span><span class="si">}</span><span class="s2">&quot;</span>
                             <span class="s2">&quot;square array.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">operation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">a</span> <span class="o">@</span> <span class="n">b</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Provide a convenient way to create elements of this group.&#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="n">Element</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;G</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">degree</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">degree</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>
</pre></div>
</td></tr></table></div>
</div>
<p>We won’t illustrate the operation of this class, though the reader is welcome to
<a class="reference external" href="https://docs.python.org/3/reference/simple_stmts.html#import" title="(in Python v3.9)"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">import</span></code></a> the <a class="reference internal" href="example_code.html#module-example_code.groups_basic" title="example_code.groups_basic"><code class="xref py py-mod docutils literal notranslate"><span class="pre">example_code.groups_basic</span></code></a> module and experiment.
Instead, we simply note that this code is very, very similar to the
implementation of <a class="reference internal" href="example_code.html#example_code.groups_basic.CyclicGroup" title="example_code.groups_basic.CyclicGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">CyclicGroup</span></code></a> in
<a class="reference internal" href="#cyclic-group"><span class="std std-numref">Listing 8.1</span></a>. The only functionally important differences are the
definitions of the <code class="xref py py-meth docutils literal notranslate"><span class="pre">_validate()</span></code> and <code class="xref py py-meth docutils literal notranslate"><span class="pre">operation()</span></code> methods.
<code class="xref py py-obj docutils literal notranslate"><span class="pre">self.order</span></code> is also renamed as <code class="xref py py-obj docutils literal notranslate"><span class="pre">self.degree</span></code>, and <code class="xref py py-obj docutils literal notranslate"><span class="pre">C</span></code> is replaced by <code class="xref py py-obj docutils literal notranslate"><span class="pre">G</span></code> in the
string representation. It remains the case that there is a large amount of
code repetition between classes. For the reasons we touched on in
<a class="reference internal" href="4_style.html#repetition"><span class="std std-numref">Section 4.5.4</span></a>, this is a highly undesirable state of affairs.</p>
</div>
</div>
<div class="section" id="id1">
<h2><span class="section-number">8.2. </span>Inheritance<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>Suppose, instead of copying much of the same code, we had a prototype
<code class="xref py py-class docutils literal notranslate"><span class="pre">Group</span></code> class, and <code class="xref py py-class docutils literal notranslate"><span class="pre">CyclicGroup</span></code> and <code class="xref py py-class docutils literal notranslate"><span class="pre">GeneralLinearGroup</span></code>
simply specified the ways in which they differ from the prototype. This would
avoid the issues associated with repeating code, and would make it obvious how
the different group implementations differ. This is exactly what inheritance
does.</p>
<div class="literal-block-wrapper docutils container" id="groups-inheritance">
<div class="code-block-caption"><span class="caption-number">Listing 8.3 </span><span class="caption-text">Implementation of a base class for a generic group, and subclasses
for the cyclic groups and general linear groups.</span><a class="headerlink" href="#groups-inheritance" title="Permalink to this code">¶</a></div>
<div class="highlight-python3 notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Group</span><span class="p">:</span>
    <span class="sd">&#39;&#39;&#39;A base class containing methods common to many groups.</span>

<span class="sd">    Each subclass represents a family of parametrised groups.&#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Args:</span>
<span class="sd">            n: The primary group parameter, such as order or degree. The</span>
<span class="sd">            precise meaning of n changes from subclass to subclass.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="n">n</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Provide a convenient way to create elements of this group.&#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="n">Element</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">notation</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>


<span class="k">class</span> <span class="nc">CyclicGroup</span><span class="p">(</span><span class="n">Group</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;A cyclic group represented by integer addition modulo n.&#39;&#39;&#39;</span>
    <span class="n">notation</span> <span class="o">=</span> <span class="s2">&quot;C&quot;</span>

    <span class="k">def</span> <span class="nf">_validate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Ensure that value is a legitimate element value in this group.&#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Integral</span><span class="p">)</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Element value must be an integer&quot;</span>
                            <span class="sa">f</span><span class="s2">&quot; in the range [0, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">operation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span>


<span class="k">class</span> <span class="nc">GeneralLinearGroup</span><span class="p">(</span><span class="n">Group</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;The general linear group represented by n x n matrices.&#39;&#39;&#39;</span>
    <span class="n">notation</span> <span class="o">=</span> <span class="s2">&quot;G&quot;</span>

    <span class="k">def</span> <span class="nf">_validate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Ensure that value is a legitimate element value in this group.&#39;&#39;&#39;</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Element value must be a &quot;</span>
                            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="si">}</span><span class="s2"> x </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="si">}</span><span class="s2"> square array.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">operation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">a</span> <span class="o">@</span> <span class="n">b</span>
</pre></div>
</td></tr></table></div>
</div>
<p><a class="reference internal" href="#groups-inheritance"><span class="std std-numref">Listing 8.3</span></a> shows a new implementation of
<a class="reference internal" href="example_code.html#example_code.groups.CyclicGroup" title="example_code.groups.CyclicGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">CyclicGroup</span></code></a> and
<a class="reference internal" href="example_code.html#example_code.groups.GeneralLinearGroup" title="example_code.groups.GeneralLinearGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">GeneralLinearGroup</span></code></a>. These are functionally
equivalent to those presented in <a class="reference internal" href="#cyclic-group"><span class="std std-numref">Listing 8.1</span></a> and
<a class="reference internal" href="#general-linear-group"><span class="std std-numref">Listing 8.2</span></a> but have all the repeated code removed. The code
common to both families of groups is instead placed in the
<a class="reference internal" href="example_code.html#example_code.groups.Group" title="example_code.groups.Group"><code class="xref py py-class docutils literal notranslate"><span class="pre">Group</span></code></a> class. In the following sections we will
highlight the features of this code which make this work.</p>
<div class="section" id="inheritance-syntax">
<h3><span class="section-number">8.2.1. </span>Inheritance syntax<a class="headerlink" href="#inheritance-syntax" title="Permalink to this headline">¶</a></h3>
<p>Look again at the definition of <a class="reference internal" href="example_code.html#example_code.groups.CyclicGroup" title="example_code.groups.CyclicGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">CyclicGroup</span></code></a> on
line 23:</p>
<div class="highlight-python3 notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>23</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CyclicGroup</span><span class="p">(</span><span class="n">Group</span><span class="p">):</span>
</pre></div>
</td></tr></table></div>
<p>This differs from the previous class definitions we’ve seen in that the
name of the class we’re defining, <code class="xref py py-class docutils literal notranslate"><span class="pre">CyclicGroup</span></code> is followed by another
class name in brackets, <code class="xref py py-class docutils literal notranslate"><span class="pre">Group</span></code>. This <a class="reference internal" href="6_exceptions.html#term-syntax"><span class="xref std std-term">syntax</span></a> is how inheritance
is defined. It means that <code class="xref py py-class docutils literal notranslate"><span class="pre">CyclicGroup</span></code> is a <a class="reference internal" href="#term-child-class"><span class="xref std std-term">child class</span></a> of
<code class="xref py py-class docutils literal notranslate"><span class="pre">Group</span></code>. The effect of this is that any <a class="reference internal" href="3_objects.html#term-attribute"><span class="xref std std-term">attribute</span></a> defined on the
<a class="reference internal" href="#term-parent-class"><span class="xref std std-term">parent class</span></a> is also defined (is <em>inherited</em>) on the child class. In
this case, <code class="xref py py-class docutils literal notranslate"><span class="pre">CyclicGroup</span></code> does not define <code class="xref py py-meth docutils literal notranslate"><span class="pre">__init__()</span></code>,
<code class="xref py py-meth docutils literal notranslate"><span class="pre">__call__()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">__str__()</span></code> or <code class="xref py py-meth docutils literal notranslate"><span class="pre">__repr__()</span></code>. If and when any of those
<a class="reference internal" href="3_objects.html#term-method"><span class="xref std std-term">methods</span></a> are called, it is the methods from the parent class,
<code class="xref py py-class docutils literal notranslate"><span class="pre">Group</span></code> which are used. This is the mechanism that enables methods to be
shared by different classes. In this case,
<a class="reference internal" href="example_code.html#example_code.groups.CyclicGroup" title="example_code.groups.CyclicGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">CyclicGroup</span></code></a> and
<a class="reference internal" href="example_code.html#example_code.groups.GeneralLinearGroup" title="example_code.groups.GeneralLinearGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">GeneralLinearGroup</span></code></a> share these methods. A user
could also define another class which inherited from
<a class="reference internal" href="example_code.html#example_code.groups.Group" title="example_code.groups.Group"><code class="xref py py-class docutils literal notranslate"><span class="pre">Group</span></code></a>, for example to implement another family of
groups.</p>
</div>
<div class="section" id="class-attributes">
<h3><span class="section-number">8.2.2. </span>Class attributes<a class="headerlink" href="#class-attributes" title="Permalink to this headline">¶</a></h3>
<p>At line 25 of <a class="reference internal" href="#groups-inheritance"><span class="std std-numref">Listing 8.3</span></a>, the name <code class="xref py py-obj docutils literal notranslate"><span class="pre">notation</span></code> is
assigned to:</p>
<div class="highlight-python3 notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>25</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">notation</span> <span class="o">=</span> <span class="s2">&quot;C&quot;</span>
</pre></div>
</td></tr></table></div>
<p>This is also different from our previous experience: usually if we
want to set a value on an object then we do so from inside a method, and we set
a <a class="reference internal" href="3_objects.html#term-data-attribute"><span class="xref std std-term">data attribute</span></a> on the current instance, <code class="xref py py-obj docutils literal notranslate"><span class="pre">self</span></code>, using the syntax:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">notation</span> <span class="o">=</span> <span class="s2">&quot;C&quot;</span>
</pre></div>
</div>
<p>This more familiar code sets an instance attribute. In other words, an attribute
specific to each object of the class. Our new version of the code instead sets a
single attribute that is common to all objects of this class. This is called a
<a class="reference internal" href="#term-class-attribute"><span class="xref std std-term">class attribute</span></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Come back and explain class attributes in more detail.</p>
</div>
</div>
<div class="section" id="attributes-resolve-at-runtime">
<span id="runtime-attributes"></span><h3><span class="section-number">8.2.3. </span>Attributes resolve at runtime<a class="headerlink" href="#attributes-resolve-at-runtime" title="Permalink to this headline">¶</a></h3>
<p>Consider the <code class="xref py py-meth docutils literal notranslate"><span class="pre">__str__()</span></code> method:</p>
<div class="highlight-python3 notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>16
17</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">notation</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="si">}</span><span class="s2">&quot;</span>
</pre></div>
</td></tr></table></div>
<p>This code uses <code class="xref py py-obj docutils literal notranslate"><span class="pre">self.notation</span></code>, but this attribute isn’t defined anywhere on
<a class="reference internal" href="example_code.html#example_code.groups.Group" title="example_code.groups.Group"><code class="xref py py-class docutils literal notranslate"><span class="pre">Group</span></code></a>. Why doesn’t this cause an
<a class="reference external" href="https://docs.python.org/3/library/exceptions.html#AttributeError" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">AttributeError</span></code></a> to be raised? One answer is that it indeed would if we
were to instantiate <code class="xref py py-class docutils literal notranslate"><span class="pre">Group</span></code> itself:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">from</span> <span class="nn">example_code.groups</span> <span class="kn">import</span> <span class="n">Group</span>

<span class="gp">In [2]: </span><span class="n">g</span> <span class="o">=</span> <span class="n">Group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="gp">In [3]: </span><span class="nb">print</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">AttributeError</span><span class="g g-Whitespace">                            </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">3</span><span class="o">-</span><span class="n">e1cdc681402c</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="nb">print</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>

<span class="nn">~/docs/principles_of_programming/object-oriented-programming/example_code/groups.py</span> in <span class="ni">__str__</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">39</span>
<span class="g g-Whitespace">    </span><span class="mi">40</span>     <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="ne">---&gt; </span><span class="mi">41</span>         <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">notation</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">42</span>
<span class="g g-Whitespace">    </span><span class="mi">43</span>     <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="ne">AttributeError</span>: &#39;Group&#39; object has no attribute &#39;notation&#39;
</pre></div>
</div>
<p>In fact, <code class="xref py py-class docutils literal notranslate"><span class="pre">Group</span></code> is never supposed to be instantiated, it plays the role
of an <a class="reference external" href="https://docs.python.org/3/glossary.html#term-abstract-base-class" title="(in Python v3.9)"><span class="xref std std-term">abstract base class</span></a>. In other words, it’s role is to provide
functionality to classes that inherit from it, rather than to be the type of
objects itself. We will return to this in more detail in
<code class="xref std std-numref docutils literal notranslate"><span class="pre">abstract_base_classes</span></code>.</p>
<p>However, if we instead instantiate <a class="reference internal" href="example_code.html#example_code.groups.CyclicGroup" title="example_code.groups.CyclicGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">CyclicGroup</span></code></a>
then everything works:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">from</span> <span class="nn">example_code.groups</span> <span class="kn">import</span> <span class="n">CyclicGroup</span>

<span class="gp">In [2]: </span><span class="n">g</span> <span class="o">=</span> <span class="n">CyclicGroup</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="gp">In [3]: </span><span class="nb">print</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="go">C1</span>
</pre></div>
</div>
<p>The reason is that the code in methods is only executed when that method is
called, and the object <code class="xref py py-obj docutils literal notranslate"><span class="pre">self</span></code> is the actual concrete class instance, with all of
the attributes that are defined for it. In this case, even though
<code class="xref py py-meth docutils literal notranslate"><span class="pre">__str__()</span></code> is defined on <code class="xref py py-class docutils literal notranslate"><span class="pre">Group</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">self</span></code> has type
<code class="xref py py-class docutils literal notranslate"><span class="pre">CyclicGroup</span></code>, and therefore <code class="xref py py-obj docutils literal notranslate"><span class="pre">self.notation</span></code> is well-defined and has the
value <code class="xref py py-obj docutils literal notranslate"><span class="pre">&quot;C&quot;</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>need a good example for overriding methods and calling the superclass
method.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Cover defining new types of exception here.</p>
</div>
</div>
</div>
<div class="section" id="glossary">
<h2><span class="section-number">8.3. </span>Glossary<a class="headerlink" href="#glossary" title="Permalink to this headline">¶</a></h2>
<dl class="glossary simple">
<dt id="term-child-class">child class</dt><dd><p>A class which <a class="reference internal" href="#term-inheritance"><span class="xref std std-term">inherits</span></a> directly from one or more
<a class="reference internal" href="#term-parent-class"><span class="xref std std-term">parent classes</span></a>. The child class automatically has
all of the <a class="reference internal" href="3_objects.html#term-method"><span class="xref std std-term">methods</span></a> of the parent classes, unless it
declares its own methods with the same names.</p>
</dd>
<dt id="term-class-attribute">class attribute</dt><dd><p>An <a class="reference internal" href="3_objects.html#term-attribute"><span class="xref std std-term">attribute</span></a> which is declared directly on a <a class="reference internal" href="3_objects.html#term-class"><span class="xref std std-term">class</span></a>.
All instances of a class see the same value of a class attribute.</p>
</dd>
<dt id="term-composition">composition</dt><dd><p>The process of making a more complex object from other objects by
including the constituent objects as attributes of the more composite
object. Composition can be characterised as a <em>has a</em> relationship, in
contrast to <a class="reference internal" href="#term-inheritance"><span class="xref std std-term">inheritance</span></a>, which embodies an <em>is a</em> relationship.</p>
</dd>
<dt id="term-delegation">delegation</dt><dd><p>A design pattern in which an object avoids implementing a
<a class="reference internal" href="3_objects.html#term-method"><span class="xref std std-term">method</span></a> by instead calling a method on another object.</p>
</dd>
<dt id="term-inheritance">inheritance</dt><dd><p>The process of making a new class by extending or modifying one or more existing
classes.</p>
</dd>
<dt id="term-parent-class">parent class</dt><dd><p>A class from which another class, referred to as a <a class="reference internal" href="#term-child-class"><span class="xref std std-term">child class</span></a>,
inherits. Inheritance can be characterised as an <em>is a</em> relationship, in
contrast to <a class="reference internal" href="#term-composition"><span class="xref std std-term">composition</span></a>, which embodies an <em>has a</em> relationship.</p>
</dd>
<dt id="term-subclass">subclass</dt><dd><p>A class <code class="xref py py-obj docutils literal notranslate"><span class="pre">A</span></code> is a subclass of the class <code class="xref py py-obj docutils literal notranslate"><span class="pre">B</span></code> if <code class="xref py py-obj docutils literal notranslate"><span class="pre">A</span></code> inherits from <code class="xref py py-obj docutils literal notranslate"><span class="pre">B</span></code> either
directly or indirectly. That is, if <code class="xref py py-obj docutils literal notranslate"><span class="pre">B</span></code> is a <a class="reference internal" href="#term-parent-class"><span class="xref std std-term">parent</span></a>,
grandparent, great grandparent or further ancestor of <code class="xref py py-obj docutils literal notranslate"><span class="pre">A</span></code>.</p>
</dd>
</dl>
</div>
<div class="section" id="exercises">
<h2><span class="section-number">8.4. </span>Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">¶</a></h2>
<p>Obtain the <a class="reference internal" href="not_released.html"><span class="doc">skeleton code for these exercises from GitHub classroom</span></a>.</p>
<div class="proof proof-type-exercise" id="id2">

    <div class="proof-title">
        <span class="proof-type">Exercise 8.1</span>
        
    </div><div class="proof-content">
<p>The symmetric group of order <code class="xref py py-obj docutils literal notranslate"><span class="pre">n</span></code> is the group whose members are all the
permutations of <code class="xref py py-obj docutils literal notranslate"><span class="pre">n</span></code> symbols and whose group operation is the composition of
those permutations: <span class="math notranslate nohighlight">\(a \cdot b = a(b)\)</span>.</p>
<p>In this week’s skeleton code repository, create package called <code class="xref py py-mod docutils literal notranslate"><span class="pre">groups</span></code>
containing a module called <code class="xref py py-mod docutils literal notranslate"><span class="pre">symmetric_groups</span></code>. Define a new class
<code class="xref py py-class docutils literal notranslate"><span class="pre">SymmetricGroup</span></code> which inherits from
<a class="reference internal" href="example_code.html#example_code.groups.Group" title="example_code.groups.Group"><code class="xref py py-class docutils literal notranslate"><span class="pre">example_code.groups.Group</span></code></a> and implements the symmetric group of
order <code class="xref py py-obj docutils literal notranslate"><span class="pre">n</span></code>. You will need to implement the group operation and the validation
of group element values. Group elements can be represented by sequences
containing permutations of the integers from 0 to <code class="xref py py-obj docutils literal notranslate"><span class="pre">n-1</span></code>. You will find it
advantageous to <span class="xref std std-term">cast</span> these permutations to <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="(in NumPy v1.19)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.array()</span></code></a>
because the indexing rules for that type mean that the group operation can
simply be implemented by indexing the first permutation with the second:
<code class="xref py py-obj docutils literal notranslate"><span class="pre">a[b]</span></code>.</p>
<p>You will also need to set the <a class="reference internal" href="#term-class-attribute"><span class="xref std std-term">class attribute</span></a> <code class="xref py py-obj docutils literal notranslate"><span class="pre">notation</span></code>. For this
group, this should take the value <code class="xref py py-obj docutils literal notranslate"><span class="pre">S</span></code>.</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>You will need to <span class="xref std std-term">import</span> <a class="reference internal" href="example_code.html#example_code.groups.Group" title="example_code.groups.Group"><code class="xref py py-class docutils literal notranslate"><span class="pre">example_code.groups.Group</span></code></a>.</p>
</div>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>In implementing element validation, the builtin function <a class="reference external" href="https://docs.python.org/3/library/functions.html#sorted" title="(in Python v3.9)"><code class="xref py py-func docutils literal notranslate"><span class="pre">sorted()</span></code></a>
is likely to be useful.</p>
</div>
</div></div><div class="admonition note">
<p class="admonition-title">Note</p>
<p>Quiz exercise giving a bunch complicated inheritance pattern and asking what
various things print.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>One exercise will be to implement another family of groups by importing and
inheriting from <a class="reference internal" href="example_code.html#example_code.groups.Group" title="example_code.groups.Group"><code class="xref py py-class docutils literal notranslate"><span class="pre">Group</span></code></a>.</p>
</div>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2019-2020, David A. Ham.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.2.1.
    </div>
  </body>
</html>